Мониторинг SSL Zabbix
Мониторинг сертификатов выполняется через стороний скрипт который лежит на сервере по пути  /usr/lib/zabbix/externalscripts/check_ssl_cert.sh

Проверка сертификата на стандартном порту (443):  $/usr/lib/zabbix/externalscripts/check_ssl_cert.sh example.com

содержание скрипта

#!/bin/bash
# Сохраняем переданный первым параметром адрес хоста (доменное имя или IP-адрес) в переменную host.
host=$1
# Сохраняем второй параметр (порт). Если порт не указан явно, по умолчанию используем порт 443.
port=${2:-443}
# Выполняем команду:
#   echo | timeout 3 openssl s_client -servername "$host" -connect "$host":"$port"
# Данная команда пытается установить SSL/TLS соединение с указанным хостом и портом.
# Параметр '-servername' задаёт имя сервера для SNI (Server Name Indication).
# 'timeout 3' ограничивает время выполнения команды тремя секундами, чтобы избежать "зависания" скрипта.
#
# Далее, полученный сертификат передаётся в команду:
#   openssl x509 -enddate -noout
# которая извлекает из сертификата поле с датой окончания его действия.
#
# Затем с помощью 'cut -d= -f2' от строки "notAfter=дата" отрезается только дата.
#
# Все ошибки и лишний вывод подавляются (2>/dev/null).
end_date=$(echo | timeout 3 openssl s_client -servername "$host" -connect "$host":"$port" 2>/dev/null | openssl x509 -enddate -noout 2>/dev/null | cut -d= -f2)

# Проверяем, удалось ли нам получить дату окончания сертификата.
# Если переменная end_date пустая (то есть сертификат не получен или произошла ошибка), то:
if [ -z "$end_date" ]; then
    # Выводим "0" (например, для обработки ошибки в Zabbix)
    echo "0"
    # Завершаем выполнение скрипта с кодом возврата 1 (ошибка).
    exit 1
fi

# Если дата успешно получена, преобразуем её в Unix timestamp (количество секунд с 1970 года до даты окончания сертификата):
end_date_seconds=$(date -d "$end_date" +%s)

# Получаем текущий Unix timestamp (текущее время сервера):
now_seconds=$(date +%s)

# Вычисляем разницу в днях между датой окончания сертификата и текущей датой.
# 86400 секунд = 1 день.
days_left=$(( (end_date_seconds - now_seconds) / 86400 ))

# Выводим результат (количество оставшихся дней действия сертификата).
echo "$days_left"
